const axios = require("axios");

/**
 * Get AI response with owner awareness
 * @param {string} prompt
 * @returns {Promise<string|null>}
 */
async function getAIResponse(prompt) {
    try {
        if (!prompt) return null;

        const lower = prompt.toLowerCase();

        // âœ… OWNER FIX (hardcoded truth)
        if (
            lower.includes("owner") ||
            lower.includes("who made you") ||
            lower.includes("who created you") ||
            lower.includes("who owns you") ||
            lower.includes("your owner")
        ) {
            return "ðŸ‘‘ *My owner is Trendex.*\nHe is the developer and controller of this bot.";
        }

        const query = encodeURIComponent(prompt);
        const apiUrl = `https://api.giftedtech.web.id/api/ai/ai?apikey=gifted&q=${query}`;

        const { data } = await axios.get(apiUrl, { timeout: 15000 });

        if (!data || !data.result) return null;

        return data.result;

    } catch (error) {
        console.error("AI API Error:", error?.response?.data || error);
        return null;
    }
}

module.exports = { getAIResponse };
